<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Jadwal Satgas Adab</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    .input-group { margin-bottom: 15px; }
    textarea { width: 100%; height: 80px; }
    .output { white-space: pre-line; background: #f4f4f4; padding: 10px; border: 1px solid #ccc; margin-top: 20px; }
    .section { margin-bottom: 20px; }
    .label { font-weight: bold; }
  </style>
</head>
<body>
  <h2>🗓️ Jadwal Satgas Adab</h2>

  <div class="section">
    <label class="label">Pilih Tanggal:</label>
    <input id="tanggal" type="date" placeholder="dd/mm/yy">
  </div>

  <div class="section">
    <label class="label">👨 Laki-laki</label>
    <textarea id="laki"></textarea>
  </div>
  <div class="section">
    <label class="label">👩 Perempuan</label>
    <textarea id="perempuan"></textarea>
  </div>
  <div class="section">
    <label class="label">🤲 Tadarus</label>
    <textarea id="tadarus"></textarea>
  </div>
  <div class="section">
    <button onclick="generateJadwal()">Generate</button>
  </div>

  <div class="section">
    <label class="label">Sudah Bertugas</label>
    <textarea id="sudahBertugas" readonly></textarea>
  </div>

  <div class="output" id="jadwalOutput"></div>

  <script>
    function getRandomItems(arr, count) {
      let shuffled = arr.sort(() => 0.5 - Math.random());
      return shuffled.slice(0, count);
    }

    function generateJadwal() {
      const tanggal = document.getElementById('tanggal').value;
      const laki = document.getElementById('laki').value.split("\n").map(x => x.trim()).filter(x => x);
      const perempuan = document.getElementById('perempuan').value.split("\n").map(x => x.trim()).filter(x => x);
      const tadarus = document.getElementById('tadarus').value.split("\n").map(x => x.trim()).filter(x => x);
      const sudah = document.getElementById('sudahBertugas').value.split("\n").map(x => x.trim());

      const availableLaki = laki.filter(n => !sudah.includes(n));
      const availablePerempuan = perempuan.filter(n => !sudah.includes(n));
      const availableTadarus = tadarus.filter(n => !sudah.includes(n));

      const selectedLaki = getRandomItems(availableLaki, 6);
      const selectedPerempuan = getRandomItems(availablePerempuan, 6);
      const selectedTadarus = getRandomItems(availableTadarus, 1);

      const allSelected = [...selectedLaki, ...selectedPerempuan, ...selectedTadarus];
      const updatedSudah = [...sudah, ...allSelected].filter(Boolean);

      let output = `Jadwal petugas satgas adab ${formatTanggal(tanggal)}\n\n`;
      output += `Jaga Dalam :\n${selectedLaki[0] || ""}\n${selectedLaki[1] || ""}\n${selectedPerempuan[0] || ""}\n${selectedPerempuan[1] || ""}\n\n`;
      output += `Jaga Luar :\n${selectedLaki[2] || ""}\n${selectedLaki[3] || ""}\n${selectedPerempuan[2] || ""}\n${selectedPerempuan[3] || ""}\n\n`;
      output += `Tempat Wudhu :\n${selectedLaki[4] || ""}\n${selectedLaki[5] || ""}\n${selectedPerempuan[4] || ""}\n${selectedPerempuan[5] || ""}\n\n`;
      output += `Tadarus :\n${selectedTadarus[0] || ""}\n\n`;
      output += `Note :\nPetugas keluar kelas 5 menit sebelum bell dan langsung menempati tempat tugas masing2`;

      document.getElementById("jadwalOutput").textContent = output;
      document.getElementById("sudahBertugas").value = [...new Set(updatedSudah)].join("\n");
    }

    function formatTanggal(dateStr) {
      if (!dateStr) return 'dd/mm/yy';
      const [yyyy, mm, dd] = dateStr.split("-");
      return `${dd}/${mm}/${yyyy.slice(2)}`;
    }
  </script>
</body>
</html>
